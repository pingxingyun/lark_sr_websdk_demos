<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="format-detection" content="telephone=no, email=no" />
    <meta name="screen-orientation" content="portrait">
    <meta name="x5-orientation" content="portrait">
    <meta name="full-screen" content="yes">
    <meta name="x5-fullscreen" content="true">
    <meta name="browsermode" content="application">
    <meta name="x5-page-mode" content="app">
    <meta name="msapplication-tap-highlight" content="no">
    <meta name="HandheldFriendly" content="true">
    <meta name="MobileOptimized" content="320">
    <meta name="360-fullscreen" content="true" />

    <meta name="theme-color" content="#000000" />
    <meta name="renderer" content="webkit" />
    <!--[if IE]>
<!DOCTYPE html><html lang=""><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="format-detection" content="telephone=no, email=no"><meta name="screen-orientation" content="portrait"><meta name="x5-orientation" content="portrait"><meta name="full-screen" content="yes"><meta name="x5-fullscreen" content="true"><meta name="browsermode" content="application"><meta name="x5-page-mode" content="app"><meta name="msapplication-tap-highlight" content="no"><meta name="HandheldFriendly" content="true"><meta name="MobileOptimized" content="320"><meta name="360-fullscreen" content="true"><meta name="theme-color" content="#000000"><meta name="renderer" content="webkit"><!--[if IE]>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <![endif]-->
    <!-- 视图窗口，移动端特属的标签。 -->
    <meta name="viewport"
        content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no" />
    <meta name="description" content="lark3.0" />
    <title>平行云</title>
    <link href="./css/bootstrap.min.css" rel="stylesheet">
    <script src="./js/jquery.min.js"></script>
    <!-- 可选组件库 -->
    <!-- @see https://github.com/pingxingyun/pxy_webcommonui -->
    <script src="./js/pxy_webcommonui.min.js?v=331202304137"></script>
    <script src="./dist/larksr-web-sdk.min.js?v=331202304137"></script>
    <script src="https://unpkg.com/vconsole@latest/dist/vconsole.min.js" crossorigin="anonymous"></script>
    <script>
        // debug 
        window.onerror = function(e) {
            alert(JSON.stringify(e));
        }

        // 是否在数据通道打开时启用已选择的设备
        var useSelectedDeviceWhenDataChannelOpen = false;
        // 测试重制媒体通道
        var resetMediaChannel = true;

        var client;
        var joystick;

        $(document).ready(function () {
            // console
            var vConsole = new window.VConsole();

            function connect(serverAddress, sdkid, appliId, config) {
                if (client) {
                    client.destroy();
                }

                client = new larksr_websdk.LarkSR({
                    // 设置挂载显示的元素
                    // 注意*不要*设置为 document.documentElement
                    rootElement: document.getElementById('container'),
                    // 服务器地址,实际使用中填写您的服务器地址
                    // 如：http://222.128.6.137:8181/
                    // 当使用平行云托管服务时服务器地址自动分配,可留空。
                    serverAddress: serverAddress,
                    // 授权码
                    // authCode: '您的 SDK ID 联系 business@pingxingyun.com 获取',
                    // 视频缩放模式，默认保留宽高比，不会拉伸并完整显示在容器中
                    // scaleMode: 'contain',
                    // 0 -》 用户手动触发, 1 -》 首次点击进入触发, 2 -》 每次点击触发
                    // fullScreenMode: 0,
                    // 测试载入背景图
                    // loadingBgUrl: 'https://home-obs.pingxingyun.com/homePage_4_0/bg.jpg',
                    mobileForceLandscape: true,
                    ...config,
                });

                client.initSDKAuthCode(sdkid)
                    .then(function () {
                        // 开始连接

                        // 连接平行云托管平台的应用
                        // client.connectWithPxyHost({
                        //     // 从平行云托管平台获取
                        //     appliId: "990411595240701952",
                        //     // playerMode: 2,
                        //     // userType: 1,
                        //     // taskId: "",
                        //     // nickname: "Test",
                        // })
                        // .catch(function(e) {
                        //     console.error('enter appli falied', e);
                        //     alert(JSON.stringify(e));
                        // });

                        client.connect({
                                // 要使用的云端资源的应用 ID，从后云雀后台接口获取
                                // 参考查询应用一栏文档
                                // https://www.pingxingyun.com/online/api3_2.html?id=476
                                // 如 222.128.6.137:8181 系统下的 879414254636105728 应用
                                appliId: appliId,
                                // 其他可选参数如下
                                // 互动模式
                                //启动模式：0：普通模式, 1：互动模式（一人操作多人观看），2: 多人协同（键盘鼠标放开，需要应用配合）
                                // playerMode: 1,
                                //Task所有者:1 /  观察者:0
                                // userType: 1,
                                //口令:8位唯一码,写入TaskInfo
                                // roomCode: '',
                                // taskId: '',
                                // groups
                                // clientMac: '',
                                // groupId: '',
                                // regionId: '',
                                //指定节点分配
                                // targetServerIp: '',
                                // keys
                                // appKey: '',
                                // timestamp: '',
                                // signature: '',
                                // "extraParam.test1": "test1", // extrams
                                // "extraParam.test2": "test2", // extrams
                                // "extraParam.test3": "test3", // extrams
                            })
                            .catch(function (e) {
                                console.error('enter appli falied', e);
                                alert(JSON.stringify(e));
                            });
                    })
                    .catch(function (e) {
                        console.error('auth falied', e);
                        alert(JSON.stringify(e));
                    });

                // all event names under larksr_websdk.LarkSRClientEvent
                // larksr_websdk.LarkSRClientEvent.DATACHANNEL_TEXT same as "datachanneltext"
                // 监听连接成功事件
                client.on('connect', function (e) {
                    console.log("LarkSRClientEvent CONNECT", e);
                });
                client.on('gotremotesteam', function (e) {
                    console.log("LarkSRClientEvent gotremotesteam", e);
                });
                client.on('meidaloaded', function (e) {
                    console.log("LarkSRClientEvent meidaloaded", e);
                });
                client.on('mediaplaysuccess', function (e) {
                    console.log("LarkSRClientEvent mediaplaysuccess", e);
                    if (pxy_webcommonui.Capabilities.isMobile) {
                        // $("#joystick-container").show();
                        // joystick.resize();
                    }
                });
                client.on('mediaplayfailed', function (e) {
                    console.log("LarkSRClientEvent mediaplayfailed", e);
                });
                client.on('meidaplaymute', function (e) {
                    console.log("LarkSRClientEvent meidaplaymute", e);
                });
                client.on('playerlist', function (e) {
                    console.log("LarkSRClientEvent playerlist", e);
                });
                client.on('error', function (e) {
                    console.error("LarkSRClientEvent error", e);
                    alert(JSON.stringify(e));
                });
                client.on('info', function (e) {
                    console.log("LarkSRClientEvent info", e);
                });
                client.on('datachanneltext', function (e) {
                    console.log("LarkSRClientEvent DATACHANNEL_TEXT", e);
                });
                client.on('appclose', function (e) {
                    alert("云端应用退出");
                });

                // test video event
                client.videoElement.addEventListener('emptied', function (e) {
                    //alert(
                    //    "	The media has become empty; for example, this event is sent if the media has already been loaded (or partially loaded), and the load() method is called to reload it.");
                });

                client.videoElement.addEventListener('ended', function (e) {
                   // alert("	Playback has stopped because the end of the media was reached.");
                });

                client.videoElement.addEventListener('pause', function (e) {
                    //alert("	Playback has been paused.");
                });

                client.videoElement.addEventListener('stalled', function (e) {
                   // alert(
                    //    "	The user agent is trying to fetch media data, but data is unexpectedly not forthcoming.");
                });

                client.videoElement.addEventListener('suspend', function (e) {
                    //alert("	Media data loading has been suspended.");
                });

                client.videoElement.addEventListener('waiting', function (e) {
                   // alert("	Playback has stopped because of a temporary lack of data.");
                });

                // 
                // client.videoElement.paused
                // client.videoElement.played
                // window.addEventListener('blur', this.onWindowBlur);
                // window.addEventListener('visibilitychange', this.onWindowVisibilityChange);
                // window.addEventListener('focus', this.onWindowFocus);
                // 

                // 音频设备相关
                // 该功能匹配的服务端版本最低为 V3.2.51
                // 客户端打开后云端应用可直接通过读取声卡上的麦克风接收到音频。
                // 使用该功能要注意在后台开启智能语音功能
                // 打开音频设备，可选传入 deviceId,
                // 注意当连接成功之后打开音频或视频通道才有实际意义，如 mediaplaysuccess 之后
                // 
                // client.on('mediaplaysuccess', function(e) { 
                //    console.log("LarkSRClientEvent mediaplaysuccess", e); 
                // client.openAudio();
                // 设置已打开的音频track状态
                // client.setAudioEnable(true);
                // 关闭已打开的音频流
                // client.closeAudio();
                // 返回可用的音频设备
                // client.getConnectedAudioinputDevices();
                // });

                // 可选组件库
                // @see https://github.com/pingxingyun/pxy_webcommonui
                // sample for pxy commonui 
                // create joystick
                if (pxy_webcommonui.Capabilities.isMobile) {
                    joystick = new pxy_webcommonui.Joystick({
                        // 必填项，挂载的根元素
                        rootElement: document.getElementById('joystick-container'),

                        // 可选项，larksr 对象，由 larksr websdk 创建出来
                        // 传入后自动发送对应的按键给云端。如果不传入，应手动处理事件，如 joystickstart joystickmove joystickend
                        // npm https://www.npmjs.com/package/larksr_websdk
                        // doc https://github.com/pingxingyun/lark_sr_websdk_demos
                        // demos https://pingxingyun.github.io/webclient_sdk/
                        larksr: client,

                        //  可选项 subType  1 wasd  2 updownleftright 3 joystick 0 none
                        // 发送给云端的按键类型
                        // 类型 1 对应键盘 WASD 按键
                        // 类型 2 对应键盘上下左右箭头
                        // 类型 3 对应物理摇杆
                        // 类型 0 不发送事件
                        // 默认为 1
                        subType: 1,

                        // 可选项,摇杆的位置。
                        // 注意，如果不传入应调整父组件的位置
                        position: {
                            top: 150,
                            left: 100,
                        },

                        // 可选项，摇杆的大小
                        // 注意，如果不传入，应设置父组件的大小。不传入时摇杆与父组件大小相同
                        size: {
                            width: 150,
                            height: 150,
                        },

                        // 可选项，摇杆中间按钮的大小
                        // 注意，如果不传入，默认中间的按钮为总摇杆的 25%
                        centerSize: {
                            width: 60,
                            height: 60,
                        },

                        // 可选项，额外的摇杆样式，会附加到其他样式后面，可覆盖默认样式
                        extralJoystickStyle: '',

                        // 可选项，额外的摇杆中间按钮样式，会附加到其他样式后面，可覆盖默认样式
                        extralCenterStyle: '',

                        // 可选项，摇杆的背景图片。最终设置为样式 background-image
                        joystickBackgroundUrl: "./img/joy_stick_bottom.png",

                        // 可选项，摇杆中间按钮的背景图片，最终设置为样式 background-image
                        centerBackgroundUrl: "./img/joy_stick_top.png",

                        // 可选项，触发事件的时间间隔
                        repeatTimeout: 10,
                    });
                    // destroy joystick
                    // joystick.destroy();
                }
            }

            function close() {
                if (client) {
                    client.close();
                    client.destroy();
                    client = null;
                }
            }


            // ...
            // 主动关闭并清理资源
            // client.close();

            // ui handler
            $("#button-connect").on("click", function (e) {
                console.log('on handler connect', e);
                var serverAddress = $("#input-server-address").val();
                console.log("serverAddress ", serverAddress);
                var sdkid = $("#input-sdk-id").val();
                console.log("sdkid ", sdkid);
                var appliId = $("#input-appli-id").val();
                console.log("appli id ", appliId);
                if (!serverAddress) {
                    alert("请填写服务器地址: 如 http://192.168.0.55:8181");
                    return;
                }
                if (!sdkid) {
                    alert("请填写 SDKID");
                    return;
                }
                if (!appliId) {
                    alert("请填写应用ID")
                    return;
                }
                connect(serverAddress, sdkid, appliId, {});
            })
            $("#button-close").on("click", function (e) {
                console.log('on handler close', e);
                close();
            });
            $("#button-start-listening").on("click", function () {
                if (!client) {
                    console.warn('client not ready');
                    return;
                }
                client.op.startListening();
            });
            $("#button-stop-listening").on("click", function () {
                if (!client) {
                    console.warn('client not ready');
                    return;
                }
                client.op.stopListenling();
            });

            // media devices...
            async function getConnectedAudioinputDevices() {
                const res = await getConnectedDevices("audioinput");
                return res;
            }
            async function getConnectedAudioOutputDevices() {
                const res = await getConnectedDevices("audiooutput");
                return res;
            }
            async function getConnectedVideoinputDevices() {
                const res = await getConnectedDevices("videoinput");
                return res;
            }
            async function getConnectedDevices(type /* audioinput audiooutput videoinput*/ ) {
                const devices = await navigator.mediaDevices.enumerateDevices();
                return devices.filter(device => device.kind === type)
            }
            async function getConnectedDevice(id) {
                const devices = await navigator.mediaDevices.enumerateDevices();
                return devices.filter(device => device.deviceId === id)
            }

            navigator.mediaDevices.getUserMedia({
                    video: true,
                    audio: true
                })
                .then(function () {
                    getConnectedAudioinputDevices()
                        .then(function (res) {
                            console.log("getConnectedAudioinputDevices", res);
                            res.forEach(function (device) {
                                var deviceOption =
                                    `<option value="${device.deviceId}">${device.label}</option>`;
                                console.log('add audio intput device option', deviceOption);
                                $("#audio-input-device").append(deviceOption);
                            });
                        })
                        .catch((e) => {
                            console.error(e);
                        });

                    getConnectedAudioOutputDevices()
                        .then(function (res) {
                            console.log("getConnectedAudioOutputDevices", res)
                            res.forEach(function (device) {
                                var deviceOption =
                                    `<option value="${device.deviceId}">${device.label}</option>`;
                                console.log('add audio intput device option', deviceOption);
                                $("#audio-output-device").append(deviceOption);
                            });
                        })
                        .catch((e) => {
                            console.error(e);
                        });

                    getConnectedVideoinputDevices()
                        .then(async function (res) {
                            console.log("getConnectedVideoinputDevices", res);
                            res.forEach(function (device) {
                                var deviceOption =
                                    `<option value="${device.deviceId}">${device.label}</option>`;
                                console.log('add video intput device option', deviceOption);
                                $("#video-input-device").append(deviceOption);
                            });
                            const device = await getConnectedDevice($("#video-input-device").val());
                            console.log("video-input-device change", device);
                            if (device.length > 0) {
                                console.log("width:" + device[0].getCapabilities().width?.max +
                                    " height" + device[0].getCapabilities().height?.max);
                                $("#video-width").val(device[0].getCapabilities().width?.max);
                                $("#video-height").val(device[0].getCapabilities().height?.max);
                            }
                        })
                        .catch((e) => {
                            console.error(e);
                        });
                })

            $("#video-input-device").on("change", async function (e) {
                const device = await getConnectedDevice($("#video-input-device").val());
                console.log("video-input-device change", device);
                if (device.length > 0) {
                    console.log("width:" + device[0].getCapabilities().width.max + " height" +
                        device[0].getCapabilities().height.max);
                    $("#video-width").val(device[0].getCapabilities().width.max);
                    $("#video-height").val(device[0].getCapabilities().height.max);
                }
            });

            // handle media
            $("#open-audio").on("click", function (e) {
                console.log("open-audio");
                client.openAudio();
            });
            $("#close-audio").on("click", function (e) {
                console.log("close-audio");
                client.closeAudio();
            });
            $("#open-video").on("click", function (e) {
                console.log("open-video");
                client.openVideo();
            });
            $("#close-video").on("click", function (e) {
                console.log("close-video");
                client.closeVideo();
            });
            $("#open-share").on("click", function (e) {
                console.log("open-share");
                client.openShareMediaDevice();
            });
            $("#close-share").on("click", function (e) {
                console.log("close-share");
                client.closeShare();
            });
            $("#close-closeMediaChannel").on("click", function (e) {
                console.log("closeMediaChannel");
                client.closeMediaChannel();
            });

            $("#open-audio-input-device").on("click", function (e) {
                console.log('open-audio-input-device', $("#audio-input-device").val());
                client.openAudioDevice($("#audio-input-device").val(), 'audioinput')
                    .then(function (res) {})
                    .catch(function (e) {
                        console.log('open audio input device failed', e);
                    });
            });
            $("#open-audio-output-device").on("click", function (e) {
                console.log('open-audio-output-device', $("#audio-output-device").val());
                client.openAudioDevice($("#audio-output-device").val(), 'audiooutput');
            });
            $("#close-audio-input-device").on("click", function (e) {
                client.closeAudio();
            });

            $("#stop-audio-input-device").on("click", function (e) {
                client.stopLocalAudio();
            });
            $("#pause-audio-input-device").on("click", function (e) {
                client.pauseAudioSending();
            });
            $("#resume-audio-input-device").on("click", function (e) {
                client.resumeAudioSending();
            });

            $("#enum-audio-input-device").on("click", function (e) {
                navigator.mediaDevices.enumerateDevices()
                    .then(function (res) {
                        $("#audio-input-device").find('option').remove().end();
                        res.forEach(function (des) {
                            // console.log(des)
                            if (!des.getCapabilities || des.kind !== "audioinput")
                                return;
                            console.log("device " + des.label + " caps " + JSON.stringify(
                                des.getCapabilities()))


                            var deviceOption =
                                `<option value="${des.deviceId}">${des.label}</option>`;
                            console.log('add audio intput device option', deviceOption);
                            $("#audio-input-device").append(deviceOption);
                        })
                    })
            });


            $("#open-video-input-device").on("click", function (e) {
                var width = parseInt($("#video-width").val());
                var height = parseInt($("#video-height").val());
                width = isNaN(width) || width === null ? 1280 : width;
                height = isNaN(height) || height == null ? 720 : height;

                console.log('open-video-input-device', $("#video-input-device").val(), width, height);

                if (resetMediaChannel) {
                    // 重制媒体通道
                    client.openUserMeida({
                            audio: false,
                            video: {
                                deviceId: $("#video-input-device").val(),
                                width,
                                height,
                            }
                        }, false)
                        .then(function (res) {})
                        .catch(function (e) {
                            console.error('open video input device failed', e);
                        });
                } else {
                    client.openVideo(false, $("#video-input-device").val(), width, height)
                        .then(function (res) {})
                        .catch(function (e) {
                            console.error('open video input device failed', e);
                        });
                }
            });

            $("#open-video-input-device-front").on("click", function (e) {
                var width = parseInt($("#video-width").val());
                var height = parseInt($("#video-height").val());
                width = isNaN(width) || width === null ? 1280 : width;
                height = isNaN(height) || height == null ? 720 : height;

                console.log('open-video-input-device-front', $("#video-input-device").val(), width, height);


                client.openVideo(false, "", width, height, true)
                    .then(function (res) {})
                    .catch(function (e) {
                        console.error('open video input device failed', e);
                    });
            });

            $("#open-video-input-device-back").on("click", function (e) {
                var width = parseInt($("#video-width").val());
                var height = parseInt($("#video-height").val());
                width = isNaN(width) || width === null ? 1280 : width;
                height = isNaN(height) || height == null ? 720 : height;

                console.log('open-video-input-device-back', $("#video-input-device").val(), width, height);


                client.openVideo(false, "", width, height, false)
                    .then(function (res) {})
                    .catch(function (e) {
                        console.error('open video input device failed', e);
                    });
            });

            $("#close-video-input-device").on("click", function (e) {
                client.closeVideo();
            });

            $("#stop-video-input-device").on("click", function (e) {
                client.stopLocalVideo();
            });
            $("#pause-video-input-device").on("click", function (e) {
                client.pauseVideoSending();
            });
            $("#resume-video-input-device").on("click", function (e) {
                client.resumeVideoSending();
            });

            $("#enum-video-input-device").on("click", function (e) {
                navigator.mediaDevices.enumerateDevices()
                    .then(function (res) {
                        $("#video-input-device").find("optioni").remove().end();
                        res.forEach(function (des) {
                            // console.log(des)
                            if (!des.getCapabilities || des.kind !== "videoinput")
                                return;
                            console.log("device " + des.label + " caps " + JSON.stringify(
                                des.getCapabilities()))

                            var deviceOption =
                                `<option value="${des.deviceId}">${des.label}</option>`;
                            console.log('add video intput device option', deviceOption);
                            $("#video-input-device").append(deviceOption);
                        })
                    });
            });

            $("#only-open-video-input-device").on("click", function (e) {
                var width = parseInt($("#video-width").val());
                var height = parseInt($("#video-height").val());
                width = isNaN(width) || width === null ? 1280 : width;
                height = isNaN(height) || height == null ? 720 : height;

                console.log('only-open-video-input-device', $("#video-input-device").val(), width,
                    height);

                navigator.mediaDevices.getUserMedia({
                        audio: false,
                        video: {
                            deviceId: $("#video-input-device").val(),
                            width,
                            height,
                        }
                    })
                    .then(function (res) {
                        console.warn("测试getUserMedia成功", res);
                    })
                    .catch(function (e) {
                        console.warn("测试getUserMedia失败", e);
                    })
            });

            $("#button-datachannel").on("click", function (e) {
                var text = $("#input-datachannel").val();
                console.log("input-datachannel ", text);
                client.sendTextToDataChannel(text);
            });
            $("#input-datachannel").on("focus", function () {
                console.log("focus");
                client.op.setKeyboardEnable(false);
            });
            $("#input-datachannel").on("blur", function () {
                console.log("blur");
                client.op.setKeyboardEnable(true);
            });


            // setup with url
            (function () {
                var urlParams = new URLSearchParams(window.location.search);
                var ip = urlParams.get('serverIp');
                var port = urlParams.get('serverPort');
                var sdkId = urlParams.get('sdkId');
                var appliId = urlParams.get('appliId');
                var autoPlay = urlParams.get('autoPlay');
                var showPlayButton = urlParams.get('showPlayButton');
                var showPlayButton = urlParams.get('showPlayButton');
                var useSeparateMediaSharePeer = urlParams.get('useSeparateMediaSharePeer');
                var language = urlParams.get('language');

                console.log("load urlparrams", ip, port, sdkId, appliId, autoPlay, showPlayButton);

                var serverAddress = "";
                var config = {};

                if (autoPlay != null && autoPlay != undefined) {
                    config.autoPlay = autoPlay === "true" ? true : false;
                }
                if (showPlayButton != null && showPlayButton != undefined) {
                    config.showPlayButton = showPlayButton === "true" ? true : false;
                }
                if (useSeparateMediaSharePeer != null && useSeparateMediaSharePeer != undefined) {
                    config.useSeparateMediaSharePeer = useSeparateMediaSharePeer === 'true' ? true : false;
                }
                if (language != null && language != undefined) {
                    config.language = language;
                }

                if (ip && port) {
                    serverAddress = (window.location.protocol.indexOf("https") > -1 ? "https" : "http") +
                        "://" + ip + ":" + port;
                    $("#input-server-address").val(serverAddress);
                }
                if (sdkId) {
                    $("#input-sdk-id").val(sdkId);
                }
                if (appliId) {
                    $("#input-appli-id").val(appliId);
                }
                if (ip && port && sdkId && appliId) {
                    // 模拟异步创建
                    window.setTimeout(function () {
                        connect(serverAddress, sdkId, appliId, config);
                    }, 1000);
                }
            })();

            $("#joystick-container").hide();

            var showBlock = true;
            $("#toggle-ui").on("click", function () {
                console.log("toggle-ui", showBlock);
                if (showBlock) {
                    $(".test-functions").hide();
                    showBlock = false;
                } else {
                    $(".test-functions").show();
                    showBlock = true;
                }
            });

            $("#canvas-render").on("click", function() {
                if (client) {
                    client.enableCanvasRender = true;
                }
            });

            $("#video-render").on("click", function() {
                if (client) {
                    client.enableCanvasRender = false;
                }
            });

            $("#button-scalemode-fill").on("click", function() {
                if (client) {
                    client.scaleMode = "fill_stretch";
                }
            });

            $("#button-scalemode-cover").on("click", function() {
                if (client) {
                    client.scaleMode = "fill_clip";
                }
            });

            $("#button-scalemode-contain").on("click", function() {
                if (client) {
                    client.scaleMode = "contain";
                }
            });

            $("#full-screen").on("click", function() {
                if (client) {
                    client.fullScreen.launchFullScreen();
                }
            });

            $("#exit-full-screen").on("click", function() {
                if (client) {
                    client.fullScreen.exitFullscreen();
                }
            });
        });
    </script>
    <style>
        .ui {
            position: absolute;
            top: 0;
            left: 0;
            z-index: 1000;
            pointer-events: none;
        }

        .ui button {
            pointer-events: all;
        }

        .ui .block {
            padding: 10px;
        }

        .ui select,
        .ui input {
            pointer-events: all;
        }

        .ui #joystick-container {
            position: absolute;
            top: 0;
            left: 0;
            pointer-events: all;
            z-index: 2000;
        }
    </style>
</head>

<body>
    <div id="container">
        <!-- 演示 UI 层 -->
        <div class="ui">
            <div class="block">
                <p>LarkSR WebSDK TestV3.2.341-331202304137</p>
            </div>
            <div class="block">
                <input placeholder="服务器地址,如 http://192.168.0.55:8181" id="input-server-address" type="text" />
                <input placeholder="SDK授权码" id="input-sdk-id" type="text" />
                <input placeholder="应用ID" id="input-appli-id" type="text" />
                <button id="button-connect">连接</button>
                <button id="button-close">关闭</button>
                <button id="toggle-ui">
                    hide/show ui
                </button>
                <button id="canvas-render">
                    canvas
                </button>
                <button id="video-render">
                    video
                </button>
                <button id="full-screen">
                    全屏
                </button>
                <button id="exit-full-screen">
                    退出全屏
                </button>
                <p id="state"></p>
            </div>
            <div class="block test-functions">
                <button id="button-start-listening">startListening</button>
                <button id="button-stop-listening">stopListenling</button>
                <button id="button-scalemode-fill">拉伸</button>
                <button id="button-scalemode-cover">裁剪</button>
                <button id="button-scalemode-contain">原始</button>
            </div>
            <div class="block test-functions">
                <select name="音频输入设备" id="audio-input-device">
                </select>
                <button id="open-audio-input-device">打开音频输入设备</button>
                <button id="close-audio-input-device">关闭音频输入设备</button>
                <button id="enum-audio-input-device">枚举音频设备信息</button>
                <button id="stop-audio-input-device">停止音频</button>
                <button id="pause-audio-input-device">暂停音频</button>
                <button id="resume-audio-input-device">恢复音频</button>
            </div>
            <div class="block test-functions">
                <select id="video-input-device">
                </select>
                <button id="open-video-input-device">打开视频输入设备</button>
                <button id="open-video-input-device-front">打开视频输入设备(前)</button>
                <button id="open-video-input-device-back">打开视频输入设备(后)</button>
                <button id="close-video-input-device">关闭视频输入设备</button>
                <button id="enum-video-input-device">枚举视频设备信息</button>
                <button id="stop-video-input-device">停止视频</button>
                <button id="pause-video-input-device">暂停视频</button>
                <button id="resume-video-input-device">恢复视频</button>
                <input placeholder="width" id="video-width" type="text" value="1280" />
                <input placeholder="height" id="video-height" type="text" value="720" />
                <button id="only-open-video-input-device">仅测试打开</button>
            </div>
            <div class="block test-functions">
                <input placeholder="发送给云端数据通道" id="input-datachannel" type="text" />
                <button id="button-datachannel">发送</button>
                <p id="text-from-datachannel"></p>
            </div>
            <div id="joystick-container">
            </div>
        </div>
    </div>
</body>

</html>