<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="apple-mobile-web-app-capable" content="yes" />
  
    <meta name="renderer" content="webkit" />

    <meta name="viewport"
        content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no" />
    <meta name="description" content="lark3.0" />
    <title>iOS 17 TestObjectFit-Fill</title>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            console.log("ready");

            var canvas = document.getElementById("canvas");
            canvas.width = 100;
            canvas.height = 100;

            var video = document.getElementById("video");

            video.srcObject = canvas.captureStream();

            var gl = canvas.getContext("webgl");

            function draw() {
                gl.clearColor(0.0, 0.0, 1.0, 1.0);
                gl.clear(gl.COLOR_BUFFER_BIT);
                // render option
                window.requestAnimationFrame(draw)
            }

            draw();

            document.getElementById('btn-play').addEventListener("click", function() {
                video.play();
            });
        });
    </script>
    <style>
        body {
            background-color: #f0f0f0;
        }
        
        #video {
            width: 300px;
            height: 100px;
            object-fit: fill;
            border: 1px solid green;   
        }
        #canvas {
            width: 100px;
            height: 100px;
            border: 1px solid yellow;   
        }
    </style>
</head>

<body>
<div>
    <h1>iOS 17 TestObjectFit-Fill with video srcObject</h1>
    <div>
        <p>video element with object-fit: fill;</p>
        <video id="video" autoplay="autoPlay" playsInline="playsInline"></video>
        <button id="btn-play">play</button>
    </div>
    <div>
        <p>canvas as video srcObject</p>
        <canvas id="canvas" width="100" height="100"></canvas>
    </div>
</div>
</body>

</html>